<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenDTAM: /home/nick/Programming/ComputerVision/OpenDTAM-3.1/Cpp/CostVolume/optimizer.part.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenDTAM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/de2/optimizer_8part_8cpp_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">optimizer.part.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d2/de2/optimizer_8part_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;opencv2/core/core.hpp&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;opencv2/opencv.hpp&gt;</span> </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;opencv2/imgproc/imgproc.hpp&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;opencv2/imgproc/types_c.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;opencv2/highgui/highgui.hpp&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d31/graphics_8hpp.html">graphics.hpp</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d1a/set__affinity_8h.html">set_affinity.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d29/_cost_8h.html">Cost.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//relations: </span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//gwhatever=0.5*(gwhatever+ghere)</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//gright,gdown are negated</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dcc/namespacestd.html">std</a>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d2/d75/namespacecv.html">cv</a>;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">   18</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">size_t</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//some defines to make typing all this easier</span></div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#a249d857dfa044493c7f29844b7b0baae">   22</a></span>&#160;<span class="preprocessor">#define down (point+w)</span></div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">   23</a></span>&#160;<span class="preprocessor">#define up (point-w)</span></div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#ae545bf658b2c876abbbae55a7d12875f">   24</a></span>&#160;<span class="preprocessor">#define right (point+1)</span></div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">   25</a></span>&#160;<span class="preprocessor">#define left (point-1)</span></div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">   26</a></span>&#160;<span class="preprocessor">#define here (point)</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">   27</a></span>&#160;<span class="preprocessor">#define gdown gd[here]</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">   28</a></span>&#160;<span class="preprocessor">#define gup gu[here]</span></div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">   29</a></span>&#160;<span class="preprocessor">#define gleft gl[here]</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">   30</a></span>&#160;<span class="preprocessor">#define gright gr[here]</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#a6f380c17799d70353cd255476e06c322">   32</a></span>&#160;<span class="preprocessor">#define QUIET_DTAM 0</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dfd/quiet_8hpp.html">quiet.hpp</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../dc/da1/class_cost.html#a4a0cb8a36610465b489797100d3fff56">   40</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/da1/class_cost.html#a4a0cb8a36610465b489797100d3fff56">Cost::initOptimization</a>(){<span class="comment">//must be thread safe in allocations(i.e. don&#39;t do any after first time!)</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a>=cols;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">int</span> h=rows;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    cacheGValues();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    cv::Mat loInd(rows,cols,CV_32SC1);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    cv::Mat loVal(rows,cols,CV_32FC1);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    minv(data,loInd,loVal);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    loInd.convertTo(_a,CV_32FC1);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    assert(aptr==_a.data);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    _a.copyTo(_d);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    _qx.create(h,w,CV_32FC1);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    _qx=0.0;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    _qy.create(h,w,CV_32FC1);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    _qy=0.0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    theta=<a class="code" href="../../db/d46/_parameters_8cpp.html#a6547c76368ef247db2c4fa1f0774028c">thetaStart</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//This function has no equation, I had to derive it from the references</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">void</span> Cost::computeSigmas(){</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>, alpha,gamma,delta,mu,rho,sigma;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">float</span> L=4.0;<span class="comment">//lower is better(longer steps), but in theory only &gt;=4 is guaranteed to converge</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    lambda=1.0/theta;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    alpha=<a class="code" href="../../db/d46/_parameters_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    gamma=<a class="code" href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    delta=alpha;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    mu=2.0*sqrt(gamma*delta)/L;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    rho= mu/(2.0*gamma);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    sigma=mu/(2.0*delta);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    sigma_d = rho;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a> = sigma;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">void</span> Cost::cacheGValues(){</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a>=cols;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">int</span> h=rows;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    cout&lt;&lt; <span class="stringliteral">&quot;Caching G values&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    _gbig.create(h+2,w,CV_32FC1);  <span class="comment">//enough room to safely read off the ends</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                <span class="comment">// data will be garbage, but we don&#39;t care since we don&#39;t use it anyway</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    _g=Mat(h,w,CV_32FC1, (<span class="keywordtype">float</span>*)(_gbig.data)+w);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    _gu.create(h,w,CV_32FC1);<span class="comment">//if we read/write off the end of these something is wrong.</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    _gd.create(h,w,CV_32FC1);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    _gl.create(h,w,CV_32FC1);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    _gr.create(h,w,CV_32FC1);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">float</span>* b=(<span class="keywordtype">float</span>*)(baseImage.data);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">float</span>* g=(<span class="keywordtype">float</span>*)(_g.data);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae5256cbeb2417e5a5fd43df842b7b4fb">gd</a>=(<span class="keywordtype">float</span>*)(_gd.data);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#aeb15c514109558eaf5af5ac949b95ab4">gu</a>=(<span class="keywordtype">float</span>*)(_gu.data);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a40b529d68c033584d11338ae8e995d4e">gl</a>=(<span class="keywordtype">float</span>*)(_gl.data);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a053feec6270e8ed9b96ee8181037cb5d">gr</a>=(<span class="keywordtype">float</span>*)(_gr.data);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    Mat im_gray;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    cvtColor(baseImage,im_gray,CV_RGB2GRAY);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//first get derivatives, but use the kind that we need for our purposes, rather than the built in scharr or sobel derivatives. We will do this by getting the absolute value of the differences to each side of the the current pixel and then taking the max along each direction. The </span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    Mat gx,gy,g1,g2;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    Mat kernel=(Mat_&lt;float&gt;(1,3)&lt;&lt;0.0,-1.0,1.0);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    </div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    filter2D(im_gray,g1,-1,kernel);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    kernel=(Mat_&lt;float&gt;(1,3)&lt;&lt;-1.0,1.0,0.0);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    filter2D(im_gray,g2,-1,kernel);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    g1=abs(g1);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    g2=abs(g2);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    gx=cv::max(g1,g2);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    </div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    </div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    kernel=(Mat_&lt;float&gt;(3,1)&lt;&lt;0.0,-1.0,1.0);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    filter2D(im_gray,g1,-1,kernel);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    kernel=(Mat_&lt;float&gt;(3,1)&lt;&lt;-1.0,1.0,0.0);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    filter2D(im_gray,g2,-1,kernel);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    g1=abs(g1);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    g2=abs(g2);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    gy=cv::max(g1,g2);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    </div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    _g=gx+gy;<span class="comment">//Getting lazy, just do L1 norm</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    toc();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">//The g function (Eq. 5)</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">//the paper doesn&#39;t specify the values of the exponent or multiplier,</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// so I have chosen them to have a knee at 10% gradient, since this is a </span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//good threshold for edge detectors.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//     _g=2-_g;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    sqrt(_g,_g);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    exp(-3*_g,_g);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">//     _g=_g+epsilon;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//     _g=1;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">//_g=_g*scale_g</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">//cache interpreted forms of g, for the &quot;matrix&quot; used in</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">//section 2.2.3</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> end=w*h;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>=0; <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>&lt;end; <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>++){</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        gu[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]= 0.5*(g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]+   g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        gd[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=-0.5*(g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a249d857dfa044493c7f29844b7b0baae">down</a>]+ g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        gl[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]= 0.5*(g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a> ]+ g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        gr[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=-0.5*(g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae545bf658b2c876abbbae55a7d12875f">right</a>]+g[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../d6/d99/graphics_8cpp.html#ad9c39f421eec12b50be83d37a8cc0047">pfShow</a>(<span class="stringliteral">&quot;g&quot;</span>,_g,0,Vec2d(0,1));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/*inline float Cost::aBasic(float* data,float l,float ds,float d){</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">    int mi=0;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">    float mv=1.0/(2.0*theta)*ds*ds*(d-0)*(d-0) + data[0]*lambda; //Literal implementation of Eq.14, note the datastep^2 factor to scale correctly</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">    for(int a=1;a&lt;l;a++){</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">        float v=1.0/(2.0*theta)*ds*ds*(d-a)*(d-a) + data[a]*lambda;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">        if(v&lt;mv){</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">            mv=v;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">            mi=a;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">    if(mi==l-1||mi==0){</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">        return (float)mi;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">    float A=data[mi-1];</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">    float B=mv;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">    float C=data[mi+1];</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">    return (A-C)/(A-2*B+C)*.5+float(mi);</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">}*/</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">float</span> afunc(<span class="keywordtype">float</span>* data,<span class="keywordtype">float</span> theta,<span class="keywordtype">float</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,<span class="keywordtype">float</span> ds,<span class="keywordtype">int</span> a,<span class="keywordtype">float</span> <a class="code" href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>){</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">return</span> 1.0/(2.0*theta)*ds*ds*(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>-a)*(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>-a) + data[a]*lambda;<span class="comment">//Literal implementation of Eq.14, note the datastep^2 factor to scale correctly</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//     return 1.0/(2.0*theta)*(d-a)*(d-a) + data[a]*lambda;//forget the ds^2 factor for better numerical behavior(sometimes)</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//     return std::abs(1.0/(2.0*theta)*ds*ds*(d-a)) + data[a]*lambda;//L1 Version</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">float</span> Cost::aBasic(<span class="keywordtype">float</span>* data,<span class="keywordtype">float</span> l,<span class="keywordtype">float</span> ds,<span class="keywordtype">float</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,<span class="keywordtype">float</span>&amp; value){</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordtype">int</span> mi=0;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">float</span> vlast,vnext,v,A,B,C;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">float</span> mv=afunc(data,theta,<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,ds,0,<a class="code" href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>); </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    v=mv;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    vnext=afunc(data,theta,<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,ds,1,<a class="code" href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> a=2;a&lt;l;a++){</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        vlast=v;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        v=vnext;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        vnext=afunc(data,theta,<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,ds,a,<a class="code" href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span>(v&lt;mv){</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            A=vlast;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            C=vnext;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            mv=v;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            mi=a-1;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span>(vnext&lt;mv){<span class="comment">//last was best</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        value=vnext;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)l-1;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span>(mi==0){<span class="comment">//first was best</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        value=mv;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)mi;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    B=mv*(1.0-1.0e-8);<span class="comment">//avoid divide by zero, since B is already &lt;= others, make &lt; others</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">float</span> delt=(A-C)/(A-2*B+C)*.5;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">//value=A/2*(delt)*(delt-1)-B*(delt+1)*(delt-1)+C/2*(delt+1)*(delt);</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    value=B-(A-C)*delt/4;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">//B-(A-C)*(A-C)/(A-2*B+C)/8</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <span class="comment">// B+(C-A)*delt/2+(A-2*B+C)*delt*delt/2</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">//cout&lt;&lt;&quot;A&quot;&lt;&lt;A&lt;&lt;&quot; B&quot;&lt;&lt;B&lt;&lt;&quot; C&quot;&lt;&lt;C&lt;&lt;&quot; Ret:&quot;&lt;&lt;delt+float(mi)&lt;&lt;endl;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">//assert(fabs(delt)&lt;=.5);</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">return</span> delt+float(mi);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">// //</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">// static inline float aUpdate(float* data,int loind, int hiind, float d, float k, float range){</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">//     //k=dataStep^2/(2*theta*lambda)</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">//     int astart=max(loind,(int)(d-range))</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//     int aend=min(hiind,(int)(d+range))</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//     idx=0;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">//     mv=data[0]+</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">//     do{</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//         </span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//     }while(</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">//     if (discreteMin==loind||discreteMin==hiind){</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">//         return (float)((int)(discreteMin-loind));</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//     //we&#39;re strictly inside the safe region, so no worries about interpolation touching bad points</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//     float A=discreteMin[-1];</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">//     float B=discreteMin[0];</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//     float C=discreteMin[1];</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">//     return (A-C)/(A-2*B+C)*.5+float(discreteMin-loind);</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>* Cost_optimizeQD(<span class="keywordtype">void</span>* <span class="keywordtype">object</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>* Cost_optimizeA(<span class="keywordtype">void</span>* <span class="keywordtype">object</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> launch_optimzer_thread(<a class="code" href="../../dc/da1/class_cost.html">Cost</a>&amp; cost);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> launch_optimzer_threads(<span class="keyword">const</span> <a class="code" href="../../dc/da1/class_cost.html">Cost</a>* cost){</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    pthread_t threadQD,threadA;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    pthread_create( &amp;threadQD, NULL, Cost_optimizeQD, (<span class="keywordtype">void</span>*) cost);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    pthread_create( &amp;threadA, NULL, Cost_optimizeA, (<span class="keywordtype">void</span>*) cost);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>* Cost_optimizeQD(<span class="keywordtype">void</span>* <span class="keywordtype">object</span>){</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    pthread_setname_np(pthread_self(),<span class="stringliteral">&quot;QDthread&quot;</span>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../dc/da1/class_cost.html">Cost</a>* cost = (<a class="code" href="../../dc/da1/class_cost.html">Cost</a>*)<span class="keywordtype">object</span>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    set_affinity(2);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#a95b91bcff126768f0fd6376437259d83">running_qd</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">while</span>(cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#a4503885bd9b07d3a8da8f6109ef05278">running_a</a>){</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#ac0e7443b5e1853de6e0ebef9c4d1b261">optimizeQD</a>();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d6/d99/graphics_8cpp.html#ac216a4553c17b5cda825eaa69c9d3f6a">allDie</a>)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#a95b91bcff126768f0fd6376437259d83">running_qd</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span>* Cost_optimizeA(<span class="keywordtype">void</span>* <span class="keywordtype">object</span>){</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    pthread_setname_np(pthread_self(),<span class="stringliteral">&quot;Athread&quot;</span>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../dc/da1/class_cost.html">Cost</a>* cost = (<a class="code" href="../../dc/da1/class_cost.html">Cost</a>*)<span class="keywordtype">object</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    set_affinity(3);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#a4503885bd9b07d3a8da8f6109ef05278">running_a</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">while</span>(cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#a4503885bd9b07d3a8da8f6109ef05278">running_a</a>){</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        cost-&gt;<a class="code" href="../../dc/da1/class_cost.html#af5e8e52a3fca2cfc207e27ae7744b70f">optimizeA</a>();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="../../d6/d99/graphics_8cpp.html#ac216a4553c17b5cda825eaa69c9d3f6a">allDie</a>)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="../../dc/da1/class_cost.html#ac7b0793a16e12cb0800e2603c121fdfe">  271</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/da1/class_cost.html#ac7b0793a16e12cb0800e2603c121fdfe">Cost::optimize</a>(){</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span>(!running_a){</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// Wait for QD to be done</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">while</span>(running_qd)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          usleep(100);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        launch_optimzer_threads(<span class="keyword">this</span>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;Already running optimizer!&quot;</span>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> __attribute__ ((noinline)) qcore(</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> denom,</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">  284</a></span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>, </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>, </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a53bf0010ee65312d7eaefa9b46c48f92">kx</a>,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a68653de1c9786447488c7da575fd5226">ky</a>,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae5256cbeb2417e5a5fd43df842b7b4fb">gd</a>,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#aeb15c514109558eaf5af5ac949b95ab4">gu</a>,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a40b529d68c033584d11338ae8e995d4e">gl</a>,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a053feec6270e8ed9b96ee8181037cb5d">gr</a>,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>&amp; <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="../../dc/da1/class_cost.html#ac0e7443b5e1853de6e0ebef9c4d1b261">  296</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/da1/class_cost.html#ac0e7443b5e1853de6e0ebef9c4d1b261">Cost::optimizeQD</a>(){</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a>=cols;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">int</span> h=rows;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    cout&lt;&lt; <span class="stringliteral">&quot;QD optimization run:&quot;</span>&lt;&lt;QDruncount++&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">float</span> denom;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>; </div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>; </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a53bf0010ee65312d7eaefa9b46c48f92">kx</a>=(<span class="keywordtype">float</span>*)(_qx.data);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a68653de1c9786447488c7da575fd5226">ky</a>=(<span class="keywordtype">float</span>*)(_qy.data);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>=(<span class="keywordtype">float</span>*)(_d.data);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">float</span>* a=(<span class="keywordtype">float</span>*)(_a.data);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    assert(aptr==_a.data);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">float</span>* g=(<span class="keywordtype">float</span>*)(_g.data);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae5256cbeb2417e5a5fd43df842b7b4fb">gd</a>=(<span class="keywordtype">float</span>*)(_gd.data);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#aeb15c514109558eaf5af5ac949b95ab4">gu</a>=(<span class="keywordtype">float</span>*)(_gu.data);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a40b529d68c033584d11338ae8e995d4e">gl</a>=(<span class="keywordtype">float</span>*)(_gl.data);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a053feec6270e8ed9b96ee8181037cb5d">gr</a>=(<span class="keywordtype">float</span>*)(_gr.data);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    computeSigmas();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    assert(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>!=0.0);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    assert(sigma_d!=0.0);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">//q update ((4 read,1 write)*2 = 8 read, 2 write)</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;tic();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    denom=1+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>*<a class="code" href="../../db/d46/_parameters_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">float</span> nm,pd,kxn,kyn;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    point=0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> i=1;i&lt;h;i++){</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        assert(point%w==0);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        pstop=i*w-1;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        qcore(</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            denom,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            point, </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;             pstop, </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;             kx,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;             ky,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            d,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            gd,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            gu,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            gl,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            gr,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;             w);point=<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">//         for (;point&lt;pstop;point++){</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">//             //Unnumbered Eq.s at end of section 2.2.3</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">//             //Sign is flipped due to caching a negative value</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">//             //cout&lt;&lt;sigma_q&lt;&lt;endl;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">//             kxn=(kx[here] + sigma_q*((d[here]-d[right])*gright))/denom;</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">//             kyn=(ky[here] + sigma_q*((d[here]-d[down])*gdown))/denom;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">//             nm=sqrt(kxn*kxn+kyn*kyn);</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">//             pd=std::max(1.0f,nm);</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//             kx[here]=kxn/pd;</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">//             ky[here]=kyn/pd;</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">//             //kx[here]=d[here]-d[right];</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">//         }</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">//last col</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        kxn=0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        kyn=(ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] + <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>*((d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a249d857dfa044493c7f29844b7b0baae">down</a>])*<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>))/denom;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        nm=sqrt(kxn*kxn+kyn*kyn);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        pd=max(1.0f,nm);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=kyn/pd;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        point++;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">//last row</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    pstop=h*w-1;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">for</span> (;point&lt;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>;point++){</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        kxn=(kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] + <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>*((d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae545bf658b2c876abbbae55a7d12875f">right</a>])*<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>))/denom;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        kyn=0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        nm=sqrt(kxn*kxn+kyn*kyn);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        pd=max(1.0f,nm);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=kxn/pd;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=0;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">//last col,row</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;toc();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">//d update (10 read,1 write per point)</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    denom=1+sigma_d/theta;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">//top left</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    point=0;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    pstop=1;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(                 <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]               +<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]                 - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    point++;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//toprow</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    pstop+=w-2;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">for</span> (;point&lt;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>;point++){</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(             <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]                 - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">//top right</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    pstop++;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(                 <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a>]                                 - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    point++;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    assert(point%w==0);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">//core</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> corestop=w*(h-1);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">for</span>(;pstop&lt;corestop;){</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">//left core</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        pstop++;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(      <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]               +<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]             - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        point++;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">//inner core</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        pstop+=w-2;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">for</span>(;point&lt;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>;point++){</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(  <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]             - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">//right core</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        pstop++;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(      <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a>]                             - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        point++;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    assert(point==pstop);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    assert(pstop==corestop);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">//left bottom</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    pstop++;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(          <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]+                              +<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]             - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    point++;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        </div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//bottom row</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    pstop+=w-2;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">for</span>(;point&lt;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>;point++){</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(      <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]               +<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a>]+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]              - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">//bottom left</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    pstop++;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] = (d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-sigma_d*(          <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a>*ky[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a>]               +<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a>*kx[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a>]                              - a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]/theta))/denom;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    point++;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//debug</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">//     pfShow(&quot;qx&quot;,abs(_qx));</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">//     pfShow(&quot;d&quot;,_d);</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">//     pfShow(&quot;a&quot;,_a);</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    assert(aptr==_a.data);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="../../d6/d99/graphics_8cpp.html#a2f0932af29d87f0d8e57019962ba627f">gcheck</a>();</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    usleep(1);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="../../dc/da1/class_cost.html#af5e8e52a3fca2cfc207e27ae7744b70f">  446</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/da1/class_cost.html#af5e8e52a3fca2cfc207e27ae7744b70f">Cost::optimizeA</a>(){ </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    assert(aptr==_a.data);<span class="comment">//_a is read across threads, so needs to never be de/reallocated</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//usleep(1);</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    theta=theta*<a class="code" href="../../db/d46/_parameters_8cpp.html#afd344a0b8f7e8b312bd5092713f811ca">thetaStep</a>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (QDruncount&gt;1000){</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        thetaStep=.97;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (theta&lt;<a class="code" href="../../db/d46/_parameters_8cpp.html#a49c015adc62cb8f241304df1deeb3986">thetaMin</a>){<span class="comment">//done optimizing!</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        running_a=<span class="keyword">false</span>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="../../d6/d99/graphics_8cpp.html#a8d04ecae7d985a0b3390d7b22948e901">gpause</a>();</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">//         initOptimization();</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        stableDepth=_d.clone();<span class="comment">//always choose more regularized version</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        _qx=0.0;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        _qy=0.0;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        _d=stableDepth.clone();<span class="comment">//QD might be running, return the depth to it</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        theta=<a class="code" href="../../db/d46/_parameters_8cpp.html#a6547c76368ef247db2c4fa1f0774028c">thetaStart</a>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;A optimization run: &quot;</span>&lt;&lt;Aruncount++&lt;&lt;endl;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;                           Current Theta: &quot;</span>&lt;&lt;theta&lt;&lt;endl;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a>=cols;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">int</span> h=rows;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">float</span>* a=(<span class="keywordtype">float</span>*)(_a.data);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>=(<span class="keywordtype">float</span>*)(_d.data);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">//  Mat C=dataContainer/hitContainer;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordtype">int</span> l=layers;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    </div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">float</span> ds=depthStep; </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    </div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// a update</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>=0;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>&lt;w*h;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>++){</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordtype">float</span> blank;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        a[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>]=aBasic(data+<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>*l,l,ds,d[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>],blank);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="../../d6/d99/graphics_8cpp.html#ad9c39f421eec12b50be83d37a8cc0047">pfShow</a>(<span class="stringliteral">&quot;d&quot;</span>,_d,0,Vec2d(0,layers));</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="../../d6/d99/graphics_8cpp.html#ad9c39f421eec12b50be83d37a8cc0047">pfShow</a>(<span class="stringliteral">&quot;a&quot;</span>,_a,0,Vec2d(0,layers));</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">//     //debug: show the energies</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">//     Mat acost(rows,cols,CV_32FC1);</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">//     float* ap=acost.ptr&lt;float&gt;(0);</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">//     for(st point=0;point&lt;w*h;point++){</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">//         aBasic(data+point*l,l,ds,d[point],ap[point]);</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">//     }</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">//     pfShow(&quot;A Energy: &quot;, acost,0,Vec2d(0,1e-6));</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">//     float Ed=sum(acost)[0];</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">//     float Ee=sum(_qx.mul(_qx)/2*epsilon)[0];</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">//     </span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">//     cout&lt;&lt;&quot;Data Energy: &quot;&lt;&lt;Ed&lt;&lt;endl;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">//     cout&lt;&lt;&quot;Elastic Energy: &quot;&lt;&lt;Ee&lt;&lt;endl;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">//     cout&lt;&lt;&quot;Total Energy: &quot;&lt;&lt;Ed+Ee&lt;&lt;endl;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> __attribute__ ((noinline)) qcore(</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> denom,</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>, </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a> <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>, </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a53bf0010ee65312d7eaefa9b46c48f92">kx</a>,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a68653de1c9786447488c7da575fd5226">ky</a>,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae5256cbeb2417e5a5fd43df842b7b4fb">gd</a>,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#aeb15c514109558eaf5af5ac949b95ab4">gu</a>,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a40b529d68c033584d11338ae8e995d4e">gl</a>,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a053feec6270e8ed9b96ee8181037cb5d">gr</a>,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span>&amp; <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a>){</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">float</span> nm,pd,kxn,kyn;</div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="../../d2/de2/optimizer_8part_8cpp.html#adff756246502e6d97eab8fae7f8b4ee7">  515</a></span>&#160;    <span class="keywordflow">for</span> (;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>&lt;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a>;<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a>++){</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">//Unnumbered Eq.s at end of section 2.2.3</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">//Sign is flipped due to caching a negative value</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="comment">//cout&lt;&lt;sigma_q&lt;&lt;endl;</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        kxn=(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a53bf0010ee65312d7eaefa9b46c48f92">kx</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] + <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>*((<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae545bf658b2c876abbbae55a7d12875f">right</a>])*<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a>))/denom;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        kyn=(<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a68653de1c9786447488c7da575fd5226">ky</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>] + <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a>*((<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]-<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a249d857dfa044493c7f29844b7b0baae">down</a>])*<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a>))/denom;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        nm=sqrt(kxn*kxn+kyn*kyn);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        pd=std::max(1.0f,nm);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a53bf0010ee65312d7eaefa9b46c48f92">kx</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=kxn/pd;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#a68653de1c9786447488c7da575fd5226">ky</a>[<a class="code" href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a>]=kyn/pd;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">//kx[here]=d[here]-d[right];</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div><div class="ttc" id="_cost_8h_html"><div class="ttname"><a href="../../d3/d29/_cost_8h.html">Cost.h</a></div></div>
<div class="ttc" id="class_cost_html_a4a0cb8a36610465b489797100d3fff56"><div class="ttname"><a href="../../dc/da1/class_cost.html#a4a0cb8a36610465b489797100d3fff56">Cost::initOptimization</a></div><div class="ttdeci">void initOptimization()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00040">optimizer.part.cpp:40</a></div></div>
<div class="ttc" id="class_cost_html"><div class="ttname"><a href="../../dc/da1/class_cost.html">Cost</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d29/_cost_8h_source.html#l00021">Cost.h:21</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a229376d5cfc4934f3c61175d11240f2d"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a229376d5cfc4934f3c61175d11240f2d">point</a></div><div class="ttdeci">static void st point</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="_parameters_8cpp_html_afd344a0b8f7e8b312bd5092713f811ca"><div class="ttname"><a href="../../db/d46/_parameters_8cpp.html#afd344a0b8f7e8b312bd5092713f811ca">thetaStep</a></div><div class="ttdeci">thetaStep</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d46/_parameters_8cpp_source.html#l00007">Parameters.cpp:7</a></div></div>
<div class="ttc" id="_parameters_8cpp_html_a49c015adc62cb8f241304df1deeb3986"><div class="ttname"><a href="../../db/d46/_parameters_8cpp.html#a49c015adc62cb8f241304df1deeb3986">thetaMin</a></div><div class="ttdeci">thetaMin</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d46/_parameters_8cpp_source.html#l00006">Parameters.cpp:6</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_aeb15c514109558eaf5af5ac949b95ab4"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#aeb15c514109558eaf5af5ac949b95ab4">gu</a></div><div class="ttdeci">static void st const st float float const float const float const float * gu</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_ab577d2ef37f275c29cceb8da1e7c6212"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#ab577d2ef37f275c29cceb8da1e7c6212">gright</a></div><div class="ttdeci">#define gright</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00030">optimizer.part.cpp:30</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a58d91db1a217d81c681a8cf543a1af3e"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a58d91db1a217d81c681a8cf543a1af3e">d</a></div><div class="ttdeci">static void st const st float float const float * d</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="class_cost_html_ac0e7443b5e1853de6e0ebef9c4d1b261"><div class="ttname"><a href="../../dc/da1/class_cost.html#ac0e7443b5e1853de6e0ebef9c4d1b261">Cost::optimizeQD</a></div><div class="ttdeci">void optimizeQD()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00296">optimizer.part.cpp:296</a></div></div>
<div class="ttc" id="_parameters_8cpp_html_aa571c8173dde514963e974e8c1da1945"><div class="ttname"><a href="../../db/d46/_parameters_8cpp.html#aa571c8173dde514963e974e8c1da1945">epsilon</a></div><div class="ttdeci">epsilon</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d46/_parameters_8cpp_source.html#l00008">Parameters.cpp:8</a></div></div>
<div class="ttc" id="graphics_8cpp_html_ac216a4553c17b5cda825eaa69c9d3f6a"><div class="ttname"><a href="../../d6/d99/graphics_8cpp.html#ac216a4553c17b5cda825eaa69c9d3f6a">allDie</a></div><div class="ttdeci">int allDie</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d99/graphics_8cpp_source.html#l00022">graphics.cpp:22</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a280340645393989032adec9b0fb959de"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a280340645393989032adec9b0fb959de">st</a></div><div class="ttdeci">size_t st</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00018">optimizer.part.cpp:18</a></div></div>
<div class="ttc" id="namespacecv_html"><div class="ttname"><a href="../../d2/d75/namespacecv.html">cv</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/_depthmap_denoise_weighted_huber_8cpp_source.html#l00010">DepthmapDenoiseWeightedHuber.cpp:10</a></div></div>
<div class="ttc" id="class_cost_html_ac7b0793a16e12cb0800e2603c121fdfe"><div class="ttname"><a href="../../dc/da1/class_cost.html#ac7b0793a16e12cb0800e2603c121fdfe">Cost::optimize</a></div><div class="ttdeci">void optimize()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00271">optimizer.part.cpp:271</a></div></div>
<div class="ttc" id="class_cost_html_a4503885bd9b07d3a8da8f6109ef05278"><div class="ttname"><a href="../../dc/da1/class_cost.html#a4503885bd9b07d3a8da8f6109ef05278">Cost::running_a</a></div><div class="ttdeci">volatile bool running_a</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d29/_cost_8h_source.html#l00134">Cost.h:134</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_ad168922b1d1561628d162f20bc8ce420"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#ad168922b1d1561628d162f20bc8ce420">here</a></div><div class="ttdeci">#define here</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00026">optimizer.part.cpp:26</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_ae5256cbeb2417e5a5fd43df842b7b4fb"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#ae5256cbeb2417e5a5fd43df842b7b4fb">gd</a></div><div class="ttdeci">static void st const st float float const float const float * gd</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="class_cost_html_a95b91bcff126768f0fd6376437259d83"><div class="ttname"><a href="../../dc/da1/class_cost.html#a95b91bcff126768f0fd6376437259d83">Cost::running_qd</a></div><div class="ttdeci">volatile bool running_qd</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d29/_cost_8h_source.html#l00134">Cost.h:134</a></div></div>
<div class="ttc" id="class_cost_html_af5e8e52a3fca2cfc207e27ae7744b70f"><div class="ttname"><a href="../../dc/da1/class_cost.html#af5e8e52a3fca2cfc207e27ae7744b70f">Cost::optimizeA</a></div><div class="ttdeci">void optimizeA()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00446">optimizer.part.cpp:446</a></div></div>
<div class="ttc" id="_parameters_8cpp_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="../../db/d46/_parameters_8cpp.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">lambda</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d46/_parameters_8cpp_source.html#l00009">Parameters.cpp:9</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a0337592b74197133c4203f6dce657a76"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a0337592b74197133c4203f6dce657a76">up</a></div><div class="ttdeci">#define up</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00023">optimizer.part.cpp:23</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a428f8207615465afdfcf1d31547ffef3"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a428f8207615465afdfcf1d31547ffef3">left</a></div><div class="ttdeci">#define left</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00025">optimizer.part.cpp:25</a></div></div>
<div class="ttc" id="graphics_8cpp_html_a2f0932af29d87f0d8e57019962ba627f"><div class="ttname"><a href="../../d6/d99/graphics_8cpp.html#a2f0932af29d87f0d8e57019962ba627f">gcheck</a></div><div class="ttdeci">void gcheck()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d99/graphics_8cpp_source.html#l00027">graphics.cpp:27</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_ad9e3a730af24b36d018dfdba192900a6"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#ad9e3a730af24b36d018dfdba192900a6">w</a></div><div class="ttdeci">static void st const st float float const float const float const float const float const float const float const unsigned &amp; w</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="graphics_8hpp_html"><div class="ttname"><a href="../../d9/d31/graphics_8hpp.html">graphics.hpp</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_abadef4458e09dbac3a5d73599261eb55"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#abadef4458e09dbac3a5d73599261eb55">gleft</a></div><div class="ttdeci">#define gleft</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00029">optimizer.part.cpp:29</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a68653de1c9786447488c7da575fd5226"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a68653de1c9786447488c7da575fd5226">ky</a></div><div class="ttdeci">static void st const st float float * ky</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a87a223dab9cc4ea6705d0753d1549a3a"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a87a223dab9cc4ea6705d0753d1549a3a">gup</a></div><div class="ttdeci">#define gup</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00028">optimizer.part.cpp:28</a></div></div>
<div class="ttc" id="_parameters_8cpp_html_a6547c76368ef247db2c4fa1f0774028c"><div class="ttname"><a href="../../db/d46/_parameters_8cpp.html#a6547c76368ef247db2c4fa1f0774028c">thetaStart</a></div><div class="ttdeci">thetaStart</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d46/_parameters_8cpp_source.html#l00005">Parameters.cpp:5</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_ae941bc06ffca0641f9629c54c2699d49"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#ae941bc06ffca0641f9629c54c2699d49">gdown</a></div><div class="ttdeci">#define gdown</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00027">optimizer.part.cpp:27</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a5694e922f12dc0f2bea094e4542e6177"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a5694e922f12dc0f2bea094e4542e6177">sigma_q</a></div><div class="ttdeci">static void st const st float float const float const float const float const float const float const float &amp; sigma_q</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="set__affinity_8h_html"><div class="ttname"><a href="../../d8/d1a/set__affinity_8h.html">set_affinity.h</a></div></div>
<div class="ttc" id="graphics_8cpp_html_a8d04ecae7d985a0b3390d7b22948e901"><div class="ttname"><a href="../../d6/d99/graphics_8cpp.html#a8d04ecae7d985a0b3390d7b22948e901">gpause</a></div><div class="ttdeci">void gpause()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d99/graphics_8cpp_source.html#l00023">graphics.cpp:23</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_ae545bf658b2c876abbbae55a7d12875f"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#ae545bf658b2c876abbbae55a7d12875f">right</a></div><div class="ttdeci">#define right</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00024">optimizer.part.cpp:24</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a2336c5b48b45b517e750eb7df3b8c8c6"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a2336c5b48b45b517e750eb7df3b8c8c6">pstop</a></div><div class="ttdeci">static void st const st pstop</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="graphics_8cpp_html_ad9c39f421eec12b50be83d37a8cc0047"><div class="ttname"><a href="../../d6/d99/graphics_8cpp.html#ad9c39f421eec12b50be83d37a8cc0047">pfShow</a></div><div class="ttdeci">void pfShow(const string name, const Mat &amp;_mat, int defaultscale, Vec2d autoscale)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d99/graphics_8cpp_source.html#l00035">graphics.cpp:35</a></div></div>
<div class="ttc" id="quiet_8hpp_html"><div class="ttname"><a href="../../db/dfd/quiet_8hpp.html">quiet.hpp</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a40b529d68c033584d11338ae8e995d4e"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a40b529d68c033584d11338ae8e995d4e">gl</a></div><div class="ttdeci">static void st const st float float const float const float const float const float * gl</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a249d857dfa044493c7f29844b7b0baae"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a249d857dfa044493c7f29844b7b0baae">down</a></div><div class="ttdeci">#define down</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00022">optimizer.part.cpp:22</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a53bf0010ee65312d7eaefa9b46c48f92"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a53bf0010ee65312d7eaefa9b46c48f92">kx</a></div><div class="ttdeci">static void st const st float * kx</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
<div class="ttc" id="optimizer_8part_8cpp_html_a053feec6270e8ed9b96ee8181037cb5d"><div class="ttname"><a href="../../d2/de2/optimizer_8part_8cpp.html#a053feec6270e8ed9b96ee8181037cb5d">gr</a></div><div class="ttdeci">static void st const st float float const float const float const float const float const float * gr</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de2/optimizer_8part_8cpp_source.html#l00284">optimizer.part.cpp:284</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_882abde7eca0231e2bae1ceefe5e858a.html">Cpp</a></li><li class="navelem"><a class="el" href="../../dir_4124e5ee625aad0efbccc47f16a738f4.html">CostVolume</a></li><li class="navelem"><a class="el" href="../../d2/de2/optimizer_8part_8cpp.html">optimizer.part.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
